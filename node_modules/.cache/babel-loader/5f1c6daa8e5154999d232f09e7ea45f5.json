{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Dallas\\\\Desktop\\\\simbull-two\\\\src\\\\components\\\\Functionality\\\\CreateAsk.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport './functions.css';\nimport { Link } from 'react-router-dom';\nimport { db } from '../../services/firebase';\nimport firebase from 'firebase';\nimport moment from 'moment';\n\nconst CreateAsk = props => {\n  _s();\n\n  //props\n  const shares = props.shares;\n  const team = props.team;\n  const user = props.user;\n  const closeAsk = props.closeAsk; //states\n\n  const [calc, setCalc] = useState('');\n  const [showShare, setShowShare] = useState(true);\n  const [showPrice, setShowPrice] = useState(false);\n  const [askPrice, setAskPrice] = useState();\n  const [askSharesAmount, setAskSharesAmount] = useState();\n  const sharesHold = [];\n  const availableShares = [];\n  let numAvailableShares = 0;\n  let today = moment().format('YYYYMMDD'); //Functionality\n  //calc add digit\n\n  const addDigit = x => {\n    console.log(calc);\n\n    if (x === '.' && calc.substring(calc.length - 1, calc.length) === '.') {\n      return null;\n    } else {\n      if (showShare) {\n        let hold = calc;\n        let thisNum = hold.concat(x);\n        console.log(thisNum);\n        setAskSharesAmount(parseFloat(thisNum));\n        setCalc(thisNum);\n      } else if (showPrice) {\n        let hold = calc;\n        let thisNum = hold.concat(x);\n        console.log(thisNum);\n        setAskPrice(parseFloat(thisNum));\n        setCalc(thisNum);\n      }\n    }\n  };\n\n  const deleteDigit = () => {\n    if (showShare) {\n      const editedText = calc.slice(0, -1);\n      setAskSharesAmount(parseFloat(editedText));\n      setCalc(editedText);\n    } else if (showPrice) {\n      const editedText = calc.slice(0, -1);\n      setAskPrice(parseFloat(editedText));\n      setCalc(editedText);\n    }\n  };\n\n  function createAsk() {\n    let numShares = 0;\n    let totalPrice = 0;\n    db.collection('Bids').where('bidTeam', '==', team.team).get().then(snapshot => {\n      snapshot.forEach(doc => {\n        const data = doc.data();\n\n        if (data.email != user.email) {\n          if (data.bidPrice >= askPrice) {\n            numShares++;\n\n            if (numShares <= askSharesAmount) {\n              totalPrice = totalPrice + data.bidPrice;\n            }\n          }\n        }\n      });\n\n      if (numShares >= askSharesAmount && totalPrice >= askSharesAmount * askPrice) {\n        let stillCreate = window.confirm(`There are enough open bids to fill your order! You can sell your shares for $${(totalPrice / askSharesAmount).toFixed(2)} per share. Would you still like to create the offer to sell?`);\n\n        if (stillCreate) {\n          if (availableShares.length >= askSharesAmount) {\n            //if you have enough shares available to offer \n            var batch = db.batch();\n\n            for (let i = 0; i < askSharesAmount; i++) {\n              //gets the right number\n              let share = availableShares[i]; //going through the array\n\n              let thisRef1 = db.collection('Asks').doc(`${share}-${user.email}`);\n              batch.set(thisRef1, {\n                //creates a doc in Asks DB\n                askPrice: parseFloat(askPrice),\n                askOwner: user.email,\n                askShare: share,\n                team: team.team,\n                subscription: user.subscription,\n                askNum: i,\n                time: firebase.firestore.Timestamp.now(),\n                date: today\n              });\n              let thisRef2 = db.collection('Shares').doc(share);\n              batch.update(thisRef2, {\n                onTradingBlock: true,\n                currentAsk: parseFloat(askPrice)\n              });\n              let thisRef3 = db.collection('Teams').doc(team.team);\n              batch.update(thisRef3, {\n                asksAvailable: firebase.firestore.FieldValue.increment(1),\n                totalAskPrice: firebase.firestore.FieldValue.increment(parseFloat(askPrice)) //lowestAskPrice: parseFloat(askPrice) < firebase.firestore.FieldValue  ?  firebase.firestore.FieldValue : parseFloat(askPrice) \n\n              });\n            }\n\n            batch.commit().then(() => {\n              alert(`You created an offer to sell ${askSharesAmount} shares for a price per share of $${askPrice}`);\n              window.location.href = \"http://simbull.app\";\n            }).catch(error => console.log(error));\n          } else {\n            alert('you dont have enough shares or your shares are already in an offer to sell');\n          }\n        }\n      } else {\n        let answer = window.confirm(`Do you want to create an offer to sell ${askSharesAmount} shares for a price per share of $${askPrice}?`);\n\n        if (answer) {\n          if (availableShares.length >= askSharesAmount) {\n            //if you have enough shares available to offer \n            var batch = db.batch();\n\n            for (let i = 0; i < askSharesAmount; i++) {\n              //gets the right number\n              let share = availableShares[i]; //going through the array\n\n              let thisRef1 = db.collection('Asks').doc(`${share}-${user.email}`);\n              batch.set(thisRef1, {\n                //creates a doc in Asks DB\n                askPrice: parseFloat(askPrice),\n                askOwner: user.email,\n                askShare: share,\n                team: team.team,\n                subscription: user.subscription,\n                askNum: i,\n                time: firebase.firestore.Timestamp.now(),\n                date: today\n              });\n              let thisRef2 = db.collection('Shares').doc(share);\n              batch.update(thisRef2, {\n                onTradingBlock: true,\n                currentAsk: parseFloat(askPrice)\n              });\n              let thisRef3 = db.collection('Teams').doc(team.team);\n              batch.update(thisRef3, {\n                asksAvailable: firebase.firestore.FieldValue.increment(1),\n                totalAskPrice: firebase.firestore.FieldValue.increment(parseFloat(askPrice)) //lowestAskPrice: parseFloat(askPrice) < firebase.firestore.FieldValue  ?  firebase.firestore.FieldValue : parseFloat(askPrice) \n\n              });\n            }\n\n            batch.commit().then(() => {\n              alert(`You created an offer to sell ${askSharesAmount} shares for a price per share of $${askPrice}`);\n              console.log(availableShares);\n              window.location.href = \"http://simbull.app\";\n            }).catch(error => console.log(error));\n          } else {\n            alert('you dont have enough shares or your shares are already in an offer to sell');\n          } //cycle through bids to see if you can fill any of them\n\n        }\n      }\n    }).catch(error => console.log(error));\n  }\n\n  const getTeamShares = () => {\n    user.shares.map(s => {\n      let sL = s.length;\n      let newS = s.substring(0, sL - 4);\n\n      if (newS == team.team) {\n        sharesHold.push(s);\n      }\n    });\n    getAskAvailability();\n    return sharesHold.length;\n  };\n\n  function getAskAvailability() {\n    console.log(sharesHold);\n    numAvailableShares = 0;\n    sharesHold.map(t => {\n      db.collection('Shares').doc(t).get().then(doc => {\n        const data = doc.data();\n        console.log(data);\n\n        if (data.onTradingBlock == false) {\n          availableShares.push(t);\n          numAvailableShares = numAvailableShares + 1;\n        }\n\n        console.log(numAvailableShares);\n      });\n      console.log(numAvailableShares);\n      return numAvailableShares;\n    });\n  }\n\n  useEffect(() => {\n    getTeamShares();\n    getAskAvailability();\n  }, [askSharesAmount]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"TradePopup\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"SellShare\",\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        onClick: closeAsk,\n        children: /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fa fa-times-circle\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 42\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ss-title\",\n        children: \"Offer to Sell\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ss-team\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"ss-img\",\n          src: `nba_jersey/${team.team}.png`,\n          alt: \"team\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 42\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"tc-name-sim\",\n          children: \"sim\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 116\n        }, this), team.team]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ss-shares\",\n        children: [\"You own \", shares, \" shares\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 17\n      }, this), showShare && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ss-shareAmt\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"ss-share-label\",\n          children: \"Shares:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 60\n        }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"ss-shareAmt-underline\",\n          children: calc ? calc : '0'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 108\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 31\n      }, this), showPrice && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ss-shareAmt\",\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          onClick: () => {\n            setShowPrice(false);\n            setShowShare(true);\n            setCalc('');\n            setAskPrice();\n            setAskSharesAmount();\n          },\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fa fa-undo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 168\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 60\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"ss-share-label\",\n          children: \"Price:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 205\n        }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"ss-shareAmt-underline\",\n          children: calc ? calc : '0.00'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 252\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 31\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ss-btn-div\",\n        children: [showShare && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"ss-submit\",\n            onClick: () => {\n              setShowPrice(true);\n              setShowShare(false);\n              setCalc('');\n            },\n            children: \"Next\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 147\n          }, this)]\n        }, void 0, true), showPrice && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"ss-submit\",\n            onClick: createAsk,\n            children: \"Create Offer to Sell\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 116\n          }, this)]\n        }, void 0, true), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ss-btn\",\n          onClick: () => {\n            addDigit(\"1\");\n          },\n          children: \"1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ss-btn\",\n          onClick: () => {\n            addDigit(\"2\");\n          },\n          children: \"2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ss-btn\",\n          onClick: () => {\n            addDigit(\"3\");\n          },\n          children: \"3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ss-btn\",\n          onClick: () => {\n            addDigit(\"4\");\n          },\n          children: \"4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ss-btn\",\n          onClick: () => {\n            addDigit(\"5\");\n          },\n          children: \"5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ss-btn\",\n          onClick: () => {\n            addDigit(\"6\");\n          },\n          children: \"6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ss-btn\",\n          onClick: () => {\n            addDigit(\"7\");\n          },\n          children: \"7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ss-btn\",\n          onClick: () => {\n            addDigit(\"8\");\n          },\n          children: \"8\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ss-btn\",\n          onClick: () => {\n            addDigit(\"9\");\n          },\n          children: \"9\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 21\n        }, this), showPrice && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ss-btn\",\n          onClick: () => {\n            addDigit(\".\");\n          },\n          children: \".\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 35\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ss-btn\",\n          onClick: () => {\n            addDigit(\"0\");\n          },\n          children: \"0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ss-btn-2\",\n          onClick: () => {\n            deleteDigit();\n          },\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fa fa-arrow-left\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 80\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 195,\n    columnNumber: 9\n  }, this);\n};\n\n_s(CreateAsk, \"Y+N7Xd14DXE5RKb9AbAugC3a/+w=\");\n\n_c = CreateAsk;\nexport default CreateAsk;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreateAsk\");","map":{"version":3,"sources":["C:/Users/Dallas/Desktop/simbull-two/src/components/Functionality/CreateAsk.js"],"names":["React","useState","useEffect","Link","db","firebase","moment","CreateAsk","props","shares","team","user","closeAsk","calc","setCalc","showShare","setShowShare","showPrice","setShowPrice","askPrice","setAskPrice","askSharesAmount","setAskSharesAmount","sharesHold","availableShares","numAvailableShares","today","format","addDigit","x","console","log","substring","length","hold","thisNum","concat","parseFloat","deleteDigit","editedText","slice","createAsk","numShares","totalPrice","collection","where","get","then","snapshot","forEach","doc","data","email","bidPrice","stillCreate","window","confirm","toFixed","batch","i","share","thisRef1","set","askOwner","askShare","subscription","askNum","time","firestore","Timestamp","now","date","thisRef2","update","onTradingBlock","currentAsk","thisRef3","asksAvailable","FieldValue","increment","totalAskPrice","commit","alert","location","href","catch","error","answer","getTeamShares","map","s","sL","newS","push","getAskAvailability","t"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\r\nimport './functions.css'\r\nimport {Link} from 'react-router-dom'\r\nimport {db} from '../../services/firebase'\r\nimport firebase from 'firebase'\r\nimport moment from 'moment'\r\n\r\nconst CreateAsk = (props) => {\r\n    //props\r\n    const shares = props.shares\r\n    const team = props.team\r\n    const user = props.user\r\n    const closeAsk = props.closeAsk\r\n\r\n    //states\r\n    const [calc, setCalc] = useState('')\r\n    const [showShare, setShowShare] = useState(true)\r\n    const [showPrice, setShowPrice] = useState(false)\r\n    const [askPrice, setAskPrice] = useState()\r\n    const [askSharesAmount, setAskSharesAmount] = useState()\r\n\r\n    const sharesHold = []\r\n    const availableShares = []\r\n    let numAvailableShares = 0\r\n\r\n    let today = moment().format('YYYYMMDD')\r\n\r\n    //Functionality\r\n    //calc add digit\r\n    const addDigit = (x) => {\r\n        console.log(calc)\r\n        if(x === '.' && calc.substring(calc.length - 1, calc.length) === '.'){\r\n            return null\r\n        }else{\r\n            if(showShare){\r\n                let hold = calc\r\n                let thisNum = hold.concat(x)\r\n                console.log(thisNum)\r\n                setAskSharesAmount(parseFloat(thisNum))\r\n                setCalc(thisNum)\r\n            }else if(showPrice){\r\n                let hold = calc\r\n                let thisNum = hold.concat(x)\r\n                console.log(thisNum)\r\n                setAskPrice(parseFloat(thisNum))\r\n                setCalc(thisNum)\r\n            }\r\n        }\r\n        \r\n    }\r\n\r\n    const deleteDigit = () => {\r\n        if(showShare){\r\n            const editedText = calc.slice(0, -1)\r\n            setAskSharesAmount(parseFloat(editedText))\r\n            setCalc(editedText)\r\n        }else if(showPrice){\r\n            const editedText = calc.slice(0, -1)\r\n            setAskPrice(parseFloat(editedText))\r\n            setCalc(editedText)\r\n        }\r\n        \r\n    }\r\n\r\n    function createAsk() {\r\n        let numShares = 0\r\n        let totalPrice = 0\r\n        db.collection('Bids').where('bidTeam', '==', team.team).get().then((snapshot) => {\r\n            snapshot.forEach((doc) => {\r\n              const data = doc.data();\r\n              if(data.email != user.email){\r\n                if(data.bidPrice >= askPrice){\r\n                    numShares++\r\n                    if(numShares <= askSharesAmount){\r\n                        totalPrice = totalPrice + data.bidPrice\r\n                    }\r\n                }\r\n              }\r\n            });\r\n            if(numShares >= askSharesAmount && totalPrice >= (askSharesAmount * askPrice)){\r\n                let stillCreate = window.confirm(`There are enough open bids to fill your order! You can sell your shares for $${(totalPrice/askSharesAmount).toFixed(2)} per share. Would you still like to create the offer to sell?`)\r\n                if(stillCreate){\r\n                    if(availableShares.length >= askSharesAmount){ //if you have enough shares available to offer \r\n                        var batch = db.batch()\r\n                        for(let i = 0; i < askSharesAmount; i++){ //gets the right number\r\n                            let share = availableShares[i] //going through the array\r\n                            \r\n                            let thisRef1 = db.collection('Asks').doc(`${share}-${user.email}`)\r\n                            batch.set(thisRef1, { //creates a doc in Asks DB\r\n                                askPrice: parseFloat(askPrice),\r\n                                askOwner: user.email,\r\n                                askShare: share,\r\n                                team: team.team,\r\n                                subscription: user.subscription,\r\n                                askNum: i,\r\n                                time: firebase.firestore.Timestamp.now(),\r\n                                date: today\r\n                            })\r\n                            let thisRef2 = db.collection('Shares').doc(share)\r\n                            batch.update(thisRef2, {\r\n                                onTradingBlock: true,\r\n                                currentAsk: parseFloat(askPrice)\r\n                            })\r\n                            let thisRef3 = db.collection('Teams').doc(team.team)\r\n                            batch.update(thisRef3, {\r\n                                asksAvailable: firebase.firestore.FieldValue.increment(1),\r\n                                totalAskPrice: firebase.firestore.FieldValue.increment(parseFloat(askPrice)),\r\n                                //lowestAskPrice: parseFloat(askPrice) < firebase.firestore.FieldValue  ?  firebase.firestore.FieldValue : parseFloat(askPrice) \r\n                            })\r\n                        }\r\n                        batch.commit().then(()=> {\r\n                            alert(`You created an offer to sell ${askSharesAmount} shares for a price per share of $${askPrice}`)\r\n                            window.location.href = \"http://simbull.app\";\r\n                        }).catch((error) => console.log(error));\r\n                    }\r\n                    else{alert('you dont have enough shares or your shares are already in an offer to sell')}\r\n                }\r\n            }\r\n            else{\r\n                let answer = window.confirm(`Do you want to create an offer to sell ${askSharesAmount} shares for a price per share of $${askPrice}?`)\r\n                if(answer){\r\n                    if(availableShares.length >= askSharesAmount){ //if you have enough shares available to offer \r\n                        var batch = db.batch()\r\n                        for(let i = 0; i < askSharesAmount; i++){ //gets the right number\r\n                            let share = availableShares[i] //going through the array\r\n                            let thisRef1 = db.collection('Asks').doc(`${share}-${user.email}`)\r\n                            batch.set(thisRef1, { //creates a doc in Asks DB\r\n                                askPrice: parseFloat(askPrice),\r\n                                askOwner: user.email,\r\n                                askShare: share,\r\n                                team: team.team,\r\n                                subscription: user.subscription,\r\n                                askNum: i,\r\n                                time: firebase.firestore.Timestamp.now(),\r\n                                date: today\r\n                            })\r\n                            let thisRef2 = db.collection('Shares').doc(share)\r\n                            batch.update(thisRef2, {\r\n                                onTradingBlock: true,\r\n                                currentAsk: parseFloat(askPrice)\r\n                            })\r\n                            let thisRef3 = db.collection('Teams').doc(team.team)\r\n                            batch.update(thisRef3, {\r\n                                asksAvailable: firebase.firestore.FieldValue.increment(1),\r\n                                totalAskPrice: firebase.firestore.FieldValue.increment(parseFloat(askPrice)),\r\n                                //lowestAskPrice: parseFloat(askPrice) < firebase.firestore.FieldValue  ?  firebase.firestore.FieldValue : parseFloat(askPrice) \r\n                            })\r\n                        }\r\n                        batch.commit().then(()=> {\r\n                            alert(`You created an offer to sell ${askSharesAmount} shares for a price per share of $${askPrice}`)\r\n                            console.log(availableShares)\r\n                            window.location.href = \"http://simbull.app\";\r\n                        }).catch((error) => console.log(error));\r\n                    }\r\n                    else{alert('you dont have enough shares or your shares are already in an offer to sell')}\r\n                    //cycle through bids to see if you can fill any of them\r\n                }\r\n            }\r\n            \r\n          })\r\n          .catch((error) => console.log(error));\r\n    }\r\n    const getTeamShares = () => {\r\n        user.shares.map(s => {\r\n            let sL = s.length\r\n            let newS = s.substring(0, sL - 4)\r\n            if(newS == team.team){sharesHold.push(s)}\r\n        })\r\n        getAskAvailability()\r\n        return(sharesHold.length)\r\n    }\r\n    function getAskAvailability() {\r\n            console.log(sharesHold)\r\n            numAvailableShares = 0\r\n            sharesHold.map(t => {\r\n                db.collection('Shares').doc(t).get().then((doc) => {\r\n                        const data = doc.data()\r\n                        console.log(data)\r\n                        if(data.onTradingBlock == false){\r\n                            availableShares.push(t)\r\n                            numAvailableShares = numAvailableShares + 1\r\n                        } \r\n                        console.log(numAvailableShares)\r\n                })\r\n                console.log(numAvailableShares)\r\n                return numAvailableShares\r\n            })\r\n    }\r\n    useEffect(() => {\r\n        getTeamShares()\r\n        getAskAvailability()\r\n    }, [askSharesAmount])\r\n\r\n    return(\r\n        <div className=\"TradePopup\">\r\n            <div className=\"SellShare\">\r\n                <Link onClick={closeAsk}><i className=\"fa fa-times-circle\"></i></Link>\r\n                <div className=\"ss-title\">Offer to Sell</div>\r\n                <div className='ss-team'><img className=\"ss-img\"  src={`nba_jersey/${team.team}.png`} alt='team' /><span className=\"tc-name-sim\">sim</span>{team.team}</div>\r\n                <div className='ss-shares'>You own {shares} shares</div>\r\n                {showShare && <div className=\"ss-shareAmt\"><span className=\"ss-share-label\">Shares:</span> <span className=\"ss-shareAmt-underline\">{calc ? calc : '0'}</span></div>}\r\n                {showPrice && <div className=\"ss-shareAmt\"><Link onClick={()=>{setShowPrice(false);setShowShare(true);setCalc('');setAskPrice();setAskSharesAmount()}}><i className=\"fa fa-undo\"></i></Link><span className=\"ss-share-label\">Price:</span> <span className=\"ss-shareAmt-underline\">{calc ? calc : '0.00'}</span></div>}\r\n                <div className=\"ss-btn-div\">\r\n                    {showShare && <><button className=\"ss-submit\" onClick={()=>{setShowPrice(true);setShowShare(false);setCalc('')}}>Next</button><br /></>}\r\n                    {showPrice && <><button className=\"ss-submit\" onClick={createAsk}>Create Offer to Sell</button><br /></>}\r\n                    <button className=\"ss-btn\" onClick={()=>{addDigit(\"1\")}}>1</button>\r\n                    <button className=\"ss-btn\" onClick={()=>{addDigit(\"2\")}}>2</button>\r\n                    <button className=\"ss-btn\" onClick={()=>{addDigit(\"3\")}}>3</button>\r\n                    <button className=\"ss-btn\" onClick={()=>{addDigit(\"4\")}}>4</button>\r\n                    <button className=\"ss-btn\" onClick={()=>{addDigit(\"5\")}}>5</button>\r\n                    <button className=\"ss-btn\" onClick={()=>{addDigit(\"6\")}}>6</button>\r\n                    <button className=\"ss-btn\" onClick={()=>{addDigit(\"7\")}}>7</button>\r\n                    <button className=\"ss-btn\" onClick={()=>{addDigit(\"8\")}}>8</button>\r\n                    <button className=\"ss-btn\" onClick={()=>{addDigit(\"9\")}}>9</button>\r\n                    {showPrice && <button className=\"ss-btn\" onClick={()=>{addDigit(\".\")}}>.</button>}\r\n                    <button className=\"ss-btn\" onClick={()=>{addDigit(\"0\")}}>0</button>\r\n                    <button className=\"ss-btn-2\" onClick={()=>{deleteDigit()}}><i className=\"fa fa-arrow-left\"></i></button>\r\n                </div>\r\n            </div> \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default CreateAsk"]},"metadata":{},"sourceType":"module"}