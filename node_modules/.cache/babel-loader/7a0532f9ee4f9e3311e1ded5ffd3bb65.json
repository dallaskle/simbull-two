{"ast":null,"code":"import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"C:/Users/Dallas/Desktop/simbull-two/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Dallas/Desktop/simbull-two/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/Dallas/Desktop/simbull-two/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import'./Holdings.css';import{Link}from'react-router-dom';import{db}from'../../services/firebase';import firebase from'firebase';var OpenBids=function OpenBids(props){//props\nvar user=props.user;//states\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),myBids=_useState2[0],setMyBids=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),bidsLoaded=_useState4[0],setBidsLoaded=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),myBidsInd=_useState6[0],setMyBidsInd=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),updateTeamDb=_useState8[0],setUpdateTeamDb=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),show=_useState10[0],setShow=_useState10[1];//Funcitonality\nvar getMyBids=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var myBids1,myBids2,myBidTeams;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(show&&!bidsLoaded)){_context.next=8;break;}if(!(user!==0)){_context.next=8;break;}myBids1=[];myBids2=[];myBidTeams=[];_context.next=7;return db.collection('Bids').where('bidOwner','==',user.email).get().then(function(snapshot){snapshot.forEach(function(doc){var data=doc.data();myBids1.push(data);if(!myBidTeams.includes(data.bidTeam)){myBidTeams.push(data.bidTeam);}});myBidTeams.map(function(x){var thisTeam;var thisBidPrice=0;var thisBidNumOfShares=0;var last=0;myBids1.map(function(a){if(a.bidTeam==x){thisTeam=a.bidTeam;thisBidPrice=thisBidPrice+a.bidPrice;thisBidNumOfShares++;}last++;if(last==myBids1.length){myBids2.push({bidTeam:thisTeam,bidPrice:thisBidPrice/thisBidNumOfShares,bidNumOfShares:thisBidNumOfShares});}});});setMyBids(myBids2);setMyBidsInd(myBids1);});case 7:setBidsLoaded(true);case 8:case\"end\":return _context.stop();}}},_callee);}));return function getMyBids(){return _ref.apply(this,arguments);};}();useEffect(function(){getMyBids();},[show]);var showBids=function showBids(){function deleteBid(l){var batch=db.batch();myBidsInd.map(function(x){if(l.bidTeam==x.bidTeam){var thisRef1=db.collection('Bids').doc(\"\".concat(x.bidTeam,\"-\").concat(x.bidOwner,\"-$\").concat(x.bidPrice,\"-\").concat(x.bidNum));batch.delete(thisRef1);var thisRef2=db.collection('Teams').doc(l.bidTeam);batch.update(thisRef2,{totalBidPrice:firebase.firestore.FieldValue.increment(-x.bidPrice),bidsAvailable:firebase.firestore.FieldValue.increment(-1)});}});batch.commit().then(function(){alert('Deleted!');}).catch(function(error){return console.log(error);});alert(\"You are deleting your bids for \".concat(l.bidTeam,\". \"));setMyBids(myBids.filter(function(x){return x.bidTeam!=l.bidTeam;}));}return myBids.map(function(l){return/*#__PURE__*/_jsxs(\"div\",{className:\"holdings-offers-team-div\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"holdings-offers-team-name\",children:[\" \",/*#__PURE__*/_jsx(\"span\",{className:\"offers-blue-bid\",children:\"Bid\"}),/*#__PURE__*/_jsx(\"span\",{className:\"tc-name-sim\",children:\"sim\"}),l.bidTeam]}),/*#__PURE__*/_jsxs(\"div\",{className:\"holdings-offers-team-right\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"holdings-offers-team-info\",children:\"\".concat(l.bidNumOfShares,\" x $\").concat(l.bidPrice.toFixed(2))}),/*#__PURE__*/_jsx(\"button\",{className:\"holdings-offers-team-btn\",onClick:function onClick(){deleteBid(l);},children:\"cancel\"})]})]},l.bidTeam);});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"OpenBids\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"holdings-offers-div\",children:/*#__PURE__*/_jsxs(Link,{onClick:function onClick(){setShow(!show);},className:bidsLoaded?\"blk-txt\":'',to:\"#\",children:[show?'':'Open',\" Offers to Buy\"]})}),bidsLoaded&&show&&showBids(),myBids.length==0&&bidsLoaded&&show&&/*#__PURE__*/_jsx(\"div\",{className:\"Portfolio-Team-Name\",children:\"You have no current offers to buy\"})]})]});};export default OpenBids;","map":{"version":3,"sources":["C:/Users/Dallas/Desktop/simbull-two/src/components/Holdings/OpenBids.js"],"names":["React","useState","useEffect","Link","db","firebase","OpenBids","props","user","myBids","setMyBids","bidsLoaded","setBidsLoaded","myBidsInd","setMyBidsInd","updateTeamDb","setUpdateTeamDb","show","setShow","getMyBids","myBids1","myBids2","myBidTeams","collection","where","email","get","then","snapshot","forEach","doc","data","push","includes","bidTeam","map","x","thisTeam","thisBidPrice","thisBidNumOfShares","last","a","bidPrice","length","bidNumOfShares","showBids","deleteBid","l","batch","thisRef1","bidOwner","bidNum","delete","thisRef2","update","totalBidPrice","firestore","FieldValue","increment","bidsAvailable","commit","alert","catch","error","console","log","filter","toFixed"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\r\nimport './Holdings.css'\r\nimport {Link} from 'react-router-dom'\r\nimport {db} from '../../services/firebase'\r\nimport firebase from 'firebase'\r\n\r\nconst OpenBids = (props) => {\r\n    //props\r\n    const user = props.user\r\n\r\n    //states\r\n    const [myBids, setMyBids] = useState([])\r\n    const [bidsLoaded, setBidsLoaded] = useState(false)\r\n    const [myBidsInd, setMyBidsInd] = useState([])\r\n    const [updateTeamDb, setUpdateTeamDb] = useState(false)\r\n    const [show, setShow] = useState(false)\r\n\r\n    //Funcitonality\r\n    const getMyBids = async () => {\r\n        if(show && !bidsLoaded) {\r\n            if(user !== 0){\r\n                const myBids1 = []\r\n                const myBids2 = []\r\n                const myBidTeams = []\r\n                await db.collection('Bids').where('bidOwner', '==', user.email).get().then((snapshot) => {\r\n                    snapshot.forEach((doc) => {\r\n                        const data = doc.data()\r\n                        myBids1.push(data)\r\n                        if(!myBidTeams.includes(data.bidTeam)){\r\n                            myBidTeams.push(data.bidTeam)\r\n                        }\r\n                    })\r\n                    myBidTeams.map(x=> {\r\n                        let thisTeam \r\n                        let thisBidPrice = 0\r\n                        let thisBidNumOfShares = 0\r\n                        let last = 0\r\n                        myBids1.map(a => {\r\n                            if(a.bidTeam == x){\r\n                                thisTeam = a.bidTeam\r\n                                thisBidPrice = thisBidPrice + a.bidPrice\r\n                                thisBidNumOfShares++\r\n                            }\r\n                            last++\r\n                            if(last == myBids1.length){\r\n                                myBids2.push({\r\n                                    bidTeam: thisTeam,\r\n                                    bidPrice: thisBidPrice/thisBidNumOfShares,\r\n                                    bidNumOfShares: thisBidNumOfShares,\r\n                                }) \r\n                            }\r\n                        })\r\n                    })\r\n                    setMyBids(myBids2)\r\n                    setMyBidsInd(myBids1)\r\n                })\r\n                setBidsLoaded(true)\r\n            }\r\n        }\r\n    }\r\n    useEffect(() => {\r\n        getMyBids()\r\n    }, [show])\r\n\r\n    const showBids = () => {\r\n        function deleteBid(l) {\r\n           var batch = db.batch()\r\n           myBidsInd.map( x => {\r\n               if(l.bidTeam == x.bidTeam){\r\n                   let thisRef1 = db.collection('Bids').doc(`${x.bidTeam}-${x.bidOwner}-$${x.bidPrice}-${x.bidNum}`)\r\n                   batch.delete(thisRef1)\r\n                   let thisRef2 = db.collection('Teams').doc(l.bidTeam)\r\n                   batch.update(thisRef2, {\r\n                       totalBidPrice: firebase.firestore.FieldValue.increment(-x.bidPrice),\r\n                       bidsAvailable: firebase.firestore.FieldValue.increment(-1),\r\n                   })\r\n               }\r\n           })\r\n           batch.commit().then(() => {alert('Deleted!')}).catch((error) => console.log(error));\r\n           alert(`You are deleting your bids for ${l.bidTeam}. `)\r\n           setMyBids(myBids.filter(x => {return(x.bidTeam != l.bidTeam)}))\r\n       }\r\n       return(\r\n       myBids.map(l => {\r\n           return(\r\n               <div className=\"holdings-offers-team-div\" key={l.bidTeam}>\r\n                    <div className=\"holdings-offers-team-name\"> <span className='offers-blue-bid'>Bid</span><span className=\"tc-name-sim\">sim</span>{l.bidTeam}</div>\r\n                    <div className=\"holdings-offers-team-right\">\r\n                        <span className=\"holdings-offers-team-info\">{`${l.bidNumOfShares} x $${l.bidPrice.toFixed(2)}`}</span> \r\n                        <button className=\"holdings-offers-team-btn\" onClick={()=>{deleteBid(l)}}>cancel</button>\r\n                    </div> \r\n               </div>\r\n           )\r\n       })\r\n       )\r\n    }\r\n\r\n    return(\r\n        <>\r\n        <hr />\r\n        <div className=\"OpenBids\">\r\n            <div className=\"holdings-offers-div\"><Link onClick={()=>{setShow(!show)}} className={bidsLoaded ? \"blk-txt\" : ''} to=\"#\">{show ? '' : 'Open'} Offers to Buy</Link></div>\r\n            {bidsLoaded && show && showBids()}\r\n            {myBids.length == 0 && bidsLoaded && show && <div className=\"Portfolio-Team-Name\">You have no current offers to buy</div>}\r\n        </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default OpenBids"]},"metadata":{},"sourceType":"module"}